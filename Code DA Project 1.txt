WITH Jobs AS (
  SELECT *
  FROM `data-science-job-and-salaries.MainData.Main` 
)

SELECT
    job_title,
    job_category,
    salary,
    salary_in_usd,
    sum(salary_in_usd) over (partition by job_title) as sum_salary,
    salary_currency,
    employee_residence,
    employment_type,
    company_location,
  CASE
    WHEN salary_in_usd <= 100000 THEN 'Low Income'
    WHEN salary_in_usd BETWEEN 100000 AND 200000 THEN 'Mid Income'
    WHEN salary_in_usd >= 200000 THEN 'High Income'
    Else 'No Income'
  END as income_type
FROM Jobs
ORDER BY job_title  LIMIT 500